library(ROSE)

data(hacide)
str(hacide.train)
table(hacide.train$cls)
prop.table(table(hacide.train$cls))

library(rpart)
treeimb <- rpart(cls ~., data = hacide.train)
pred.treeimb <- predict(treeimb, newdata = hacide.test)
accuracy.meas(hacide.test$cls, pred.treeimb[, 2])
roc.curve(hacide.test$cls, pred.treeimb[,2], plotit = FALSE)

data_balanced_over <- ovun.sample(cls ~., data = hacide.train, method = "over", N = 1960)$data
table(data_balanced_over$cls)

data_balanced_both <- ovun.sample(cls ~., data = hacide.train, method = "both", p = 0.5, N = 1000, seed = 1)$data
table(data_balanced_both$cls)

data.rose <- ROSE(cls ~., data = hacide.train, seed = 1)$data
table(data.rose$cls)

tree.rose <- rpart(cls ~., data = data.rose)
pred.tree.rose <- predict(tree.rose, newdata = hacide.test)

roc.curve(hacide.test$cls, pred.tree.rose[,2])
