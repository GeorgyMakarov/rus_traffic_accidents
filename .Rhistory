roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 1))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 3))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")$Sensitivity
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[3]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[5]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[8]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[4]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[4,1]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[4, 1]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 9))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 12))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 15))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_rpart$bestTune
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 18))
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 20,
maxdepth = 18))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 1))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 3))
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 3))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 9))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 12))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 15))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 40,
maxdepth = 18))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 1))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 3))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[1]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[2]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[3]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")[4]
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
p <- confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
str(p)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 9))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 12))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 60,
maxdepth = 15))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 1))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 3))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 9))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 12))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 15))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 80,
maxdepth = 18))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 1))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 3))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 9))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 12))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 15))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.000, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.001, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.002, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
mod_rpart$bestTune
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.003, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.002, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.0022, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.0025, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.004, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.003, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.004, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = 0.005, #mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
set.seed(1)
mod_tree <- rpart(sev_class ~.,
data = data_rose,
method = "class",
control = rpart.control(cp = mod_rpart$bestTune,
minsplit = 100,
maxdepth = 6))
pred_tree <- predict(mod_tree, testing, type = "class")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
roc.curve(testing$sev_class, pred_tree, plotit = FALSE)
confusionMatrix(pred_rpart, testing$sev_class, positive = "serious")
confusionMatrix(pred_tree, testing$sev_class, positive = "serious")
x <- c(5, 7 , 9, 11, 13)
x <- c(5, 7, 9, 11, 13)
y <- c(6, 9, 8, 10, 15)
x
dt <- data.frame(x, y)
dt
mod <- lm(y ~ x)
mod
summary(mod)
corr(x, y)
cor(x, y)
